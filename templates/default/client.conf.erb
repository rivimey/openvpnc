<% if @type == "client" || @type == "client-bridge" -%>
client
<% end -%>


port <%= @port %>
proto <%= @proto %>
<% if @type == "server-bridge" || @type == "client-bridge" -%>
dev tap<%= @interface_num %>
<% else -%>
dev tun<%= @interface_num %>
<% end -%>

<% @plugins.each do |p| -%>
plugin <%= p %>
<% end -%>

keepalive 10 120

<% if @max_clients -%>
max-clients <%= @max_clients %>
<% end -%>

comp-lzo

local <%= @local %>
remote <%= @remote %>

<% if @routes -%>
<% @routes.each do |route| -%>
<%= route %>
<% end -%>
<% end -%>

<% if @type == "server" || @type == "server-bridge" -%>
<% if @dhcp_dns -%>
push "dhcp-option DNS <%= @dhcp_dns %>"
<% end -%>
<% if @dhcp_domain -%>
push "dhcp-option DOMAIN <%= @dhcp_domain %>"
<% end -%>
<% if @duplicate_cn -%>
duplicate-cn
<% end -%>
<% if @client_subnet_route -%>
client-config-dir ccd
route <%= @client_subnet_route %>
<% if @type == "server" || @type == "server-bridge" -%>
<% end -%>

# Keys and certificates.
<% if @type == "server" || @type == "server-bridge" -%>
ca   <%= @key_dir %>/ca.crt
key  <%= @key_dir %>/server.key
cert <%= @key_dir %>/server.crt
dh   <%= @key_dir %>/dh<%= @key_size %>.pem
<% if @type == "client" || @type == "client-bridge" -%>
ca   <%= @key_dir %>/ca.crt
cert <%= @key_dir %>/client.crt
<% end -%>

<% if @tls_key -%>
tls-auth <%= @tls_key %> 0
<% end -%>

<% if @tls_cipher -%>
tls-cipher <%= @tls_cipher %>
<% end -%>
<% if @cipher -%>
cipher <%= @cipher %>
<% end -%>

<% if @type == "server" -%>
<%= @type %> <%= @subnet %> <%= @netmask %>
<% end -%>

user <%= @user %>
group <%= @group %>

# avoid accessing certain resources on restart
persist-key
persist-tun

# current client connections
status <%= @status_log %>

# logging settings.
log-append  <%= @log %>
verb <%= @verb %>
mute <%= @mute %>

<% if @type == "server" || @type == "server-bridge" -%>
ifconfig-pool-persist /etc/openvpn/ipp.txt
script-security <%= @script_security %>
<% end -%>
